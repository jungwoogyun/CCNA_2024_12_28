--------------------------------------------------------------------------------------------------------------
1. VTP 이란
--------------------------------------------------------------------------------------------------------------
-> VLAN Trunking Protocol
-> VLAN ID 전달 프로토콜 
-> 복수의 VLAN ID를 VTP 를 사용하는 모든 SW 에 생성해주는 프로토콜

--------------------------------------------------------------------------------------------------------------
2. 필요성
--------------------------------------------------------------------------------------------------------------
-> 중간스위치에 VLAN 정보가 없을시 통신불가능
-> 모든 스위치에 빠짐없이 VLAN 정보가 필요

--------------------------------------------------------------------------------------------------------------
3. 장단점
--------------------------------------------------------------------------------------------------------------
장점 	: 편하다
단점	: VTP 구성시 주의하지 않으면 VLAN 정보가 순식간에 삭제되어 정상동작이 불가능

--------------------------------------------------------------------------------------------------------------
3. VTP  조건
--------------------------------------------------------------------------------------------------------------
1) VTP 도메인의 일치
2) 기본 트렁크 모드

--------------------------------------------------------------------------------------------------------------
4. VTP 동작방식
--------------------------------------------------------------------------------------------------------------
1. Server 에서 Vlan 을 추가,수정,삭제
2. Server 의 VTP 설정 번호(Configuration revision)의 번호가 상승(+1) 시켜 다른 스위치에게
변경된 VLAN 정보와 함꼐 전송
3. 수신한 VTP 프레임의 VTP 설정 번호가 더 높으면 자신의 VLAN 정보를 새로운 정보로 대체
4. 수신한 VTP 프레임의 VTP 설정 번호가 동일하면 수신한 프레임을 무시
5. 수신한 VTP 프레임의 VTP 설정 번호가 자신의 번호보다 낮으면 자신의 VTP 정보를 전송

--------------------------------------------------------------------------------------------------------------
5. VTP 설정 순서 
--------------------------------------------------------------------------------------------------------------
------------------------------------------
1) VTP 도메인 지정
------------------------------------------
동일한 도메인의 스위치 간에만 VLAN 정보 교환
스위치간에 VTP 도메인이 다르면 상대가 전송한 VTP 정보를 무시

------------------------------------------
2) VTP 패스워드 설정
------------------------------------------
해킹등으로 인하여 잘못된 VLAN 정보에 동기화되는 것을 방지

------------------------------------------
3) VTP 모드 지정
------------------------------------------
1) Server Mode		: VLAN 생성,수정,삭제 가능, VLAN 전달주체, 
2) Client Mode		: VLAN 생성,수정,삭제 불가, Server로부터의 Vlan 적용, 다른 SW로 전달
3) Transparent Mode 	: VLAN 생성,수정,삭제 가능, Server로부터의 Vlan 적용x, 다른 SW로 전달

------------------------------------------
4) VTP Version 지정
------------------------------------------
Version 1,2,3 존재
Version 이 동일해야 한다
Version 2에서는 Transparent 모드에서 도메인 이름과 버전을 확인하지 않는다.
Version 2에서의 Transparent 모드에는 자신과 VTP 도메인 이름과 버전이 달라도
수신한 VTP 정보를 다른 스위치에게 전송한다

Version 3
확장 VLAN 정보도 전송
사설 VLAN 정보도 전송
일반 VLAN뿐만 아니라 MST 정보도 전송
중저급 스위치에서는(ex. 3560,3750) VTP Version 3 미지원

--------------------------------------------------------------------------------------------------------------
7. 명령어
--------------------------------------------------------------------------------------------------------------
------------------------------------------
1). 설정 명령어 
------------------------------------------
vtp domain itbank
vtp password 1111
vtp mode server/client/transparent
vtp version 2

------------------------------------------
2). 확인 명령어
------------------------------------------
show vtp status
show vlan brief
show vtp password

--------------------------------------------------------------------------------------------------------------
8. 정보 확인 
--------------------------------------------------------------------------------------------------------------
Switch#show vtp status 
1)VTP Version                     : 2
2)Configuration Revision          : 0
3)Maximum VLANs supported locally : 255
4)Number of existing VLANs        : 5
5)VTP Operating Mode              : Transparent
6)VTP Domain Name                 : 
7)VTP Pruning Mode                : Disabled
8)VTP V2 Mode                     : Disabled
9)VTP Traps Generation            : Disabled
10)MD5 digest                      : 0x7D 0x5A 0xA6 0x0E 0x9A 0x72 0xA0 0x3A 
11)Configuration last modified by 0.0.0.0 at 0-0-00 00:00:00

1) VTP 버전
2) VTP 설정 번호(Configuration revision)
3) 이 스위치에서 설정할 수 있는 최대 VLAN의 수
4) 현재 설정되어 있는 VLAN 수
5) VTP 모드 
6) VTP 도메인명
7) VTP 프루닝 모드
8) VTP 버전 2 모드의 사용여부 
9) SNMP용 VTP 트랩 전송여부
10) VTP 프레임의 MD5 
11) 스위치가 VTP 정보를 전송할 떄 사용하는 IP 주소와 인터페이스를 표시


--------------------------------------------------------------------------------------------------------------
스위치 추가시 주의사항
--------------------------------------------------------------------------------------------------------------
스위치 추가시 설정 번호가 같으면 무시
스위치 추가시 설정 번호가 높으면(최신 업데이트) 높은 스위치의 VTP 적용(기존 VLAN 정보 삭제)

vtp 설정 번호 초기화

vtp mode transparent
vtp mode client
^Z

show vtp status
confuguration Revision	: 0 확인

VLAN 및 VTP 정보 삭제
delete vlan.dat
reload


--------------------------------------------------------------------------------------------------------------
VTP Pruning(가지치기) - 미 확인 
--------------------------------------------------------------------------------------------------------------
필요없는 VLAN ID 의 브로드 캐스팅 차단

config)#vtp prunning
